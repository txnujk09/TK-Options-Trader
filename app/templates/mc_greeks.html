<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Monte Carlo Options Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Shift 'Home' slightly to the right */
        .navbar-brand {
            margin-left: 10px;
        }

        /*center align Portfolio, Trade, Options Calculator, Learn */
        .navbar-nav.center-nav {
            margin: auto;
            text-align: center;
            display: flex;
            justify-content: center;
            gap: 10px;
            transform: translateX(-45px);
        }

        /*position History on the right */
        .history-dropdown {
            position: absolute;
            right: 20px;
        }

        /*dropdown styling */
        .dropdown-menu {
            display: none;
            position: absolute;
            right: 0;
            background-color: white;
            border: 1px solid #ccc;
            padding: 10px;
            list-style: none;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        /* Center content */
        .center-text {
            text-align: center;
            margin-top: 40px; 
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/">Home</a> <!--home link -->

        <!-- Centered Nav Links -->
        <div class="collapse navbar-collapse justify-content-center">
            <ul class="navbar-nav center-nav"> <!--centered nav links -->
                <li class="nav-item"><a class="nav-link" href="/portfolio">Portfolio</a></li> <!--portfolio link -->
                <li class="nav-item"><a class="nav-link" href="/trade">Trade</a></li>
                <li class="nav-item"><a class="nav-link" href="/mc_greeks">Options Calculator</a></li>
                <li class="nav-item"><a class="nav-link" href="/learn">Learn</a></li>
            </ul>
        </div>

        <!-- History Dropdown -->
        <div class="dropdown history-dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="historyDropdown">History</a> <!--history dropdown -->
            <ul class="dropdown-menu" aria-labelledby="historyDropdown">
                <li><a class="dropdown-item" href="/order_history">Order History</a></li> <!--order history link -->
                <li><a class="dropdown-item" href="/trade_history">Trade History</a></li>
            </ul>
        </div>
    </nav>

    <div class="container mt-5">
        <h1 class="center-text">Monte Carlo Options Calculator</h1>

        <div class="row mt-4 justify-content-around gap-3"> <!--row with 2 columns -->
            <!--left Column: Inputs -->
            <div class="col-md-5"> <!--left column -->
                <h3>Inputs</h3>
                <form id="mc-greeks-form">
                    <div class="mb-3">
                        <label for="IS" class="form-label">Initial Stock Price (IS)</label> <!--initial stock price input -->
                        <input type="number" id="IS" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="K" class="form-label">Strike Price (K)</label>
                        <input type="number" id="K" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="T" class="form-label">Time to Expiry (Years)</label>
                        <input type="number" id="T" step="0.01" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="r" class="form-label">Risk-Free Rate (r)</label>
                        <input type="number" id="r" step="0.01" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="sigma" class="form-label">Volatility (Ïƒ)</label>
                        <input type="number" id="sigma" step="0.01" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="option_type" class="form-label">Option Type</label>
                        <select id="option_type" class="form-control"> <!--option type dropdown -->
                            <option value="call">Call</option>
                            <option value="put">Put</option>
                        </select>
                    </div>
                </form>
            </div>

            <!-- Right column: Option Greeks results -->
            <div class="col-md-5"> <!--right column -->
                <h3>Results</h3>
                <table class="table table-striped"> <!--table to display results -->
                    <thead>
                        <tr>
                            <th>Greek</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Delta</td><td id="delta">--</td></tr>
                        <tr><td>Gamma</td><td id="gamma">--</td></tr>
                        <tr><td>Rho</td><td id="rho">--</td></tr>
                        <tr><td>Theta</td><td id="theta">--</td></tr>
                        <tr><td>Vega</td><td id="vega">--</td></tr>
                    </tbody>
                </table>

                <!--calculate button -->
                <button type="button" class="btn btn-primary mt-2" onclick="calculateMCGreeks()">Calculate</button> 

                <!--option price section -->
                <div class="mt-4">
                    <h3><strong>Option Price:</strong> <span class="text-success" id="option_price">--</span></h3> 
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript logic -->
    <script>
        function calculateMCGreeks() {
            //get user inputs
            let stockPrice = document.getElementById("IS").value; //initial stock price
            let strikePrice = document.getElementById("K").value;
            console.log("strikePrice:", strikePrice)
            let timeToExpiry = document.getElementById("T").value;
            let riskFreeRate = document.getElementById("r").value;
            let volatility = document.getElementById("sigma").value;
            let optionType = document.getElementById("option_type").value;

            // Send request to backend API
            console.log("tanuj from calculateMCGreeks()") //debugging
            fetch("/mc_greeks_calc", {
                method: "POST", //send a POST request
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    initial_stock_price: stockPrice, //send user inputs to the backend
                    K: strikePrice,
                    T: timeToExpiry,
                    r: riskFreeRate,    
                    sigma: volatility,
                    option_type: optionType
                })
            })
            .then(response => response.json())
            .then(data => {
                // Update the results dynamically
                document.getElementById("delta").innerText = data.greeks.Delta.toFixed(2); //update delta value
                document.getElementById("gamma").innerText = data.greeks.Gamma.toFixed(2);
                document.getElementById("rho").innerText = data.greeks.Rho.toFixed(2);
                document.getElementById("theta").innerText = data.greeks.Theta.toFixed(2); 
                document.getElementById("vega").innerText = data.greeks.Vega.toFixed(2);
                document.getElementById("option_price").innerText = data.option_price.toFixed(2);
            })
            .catch(error => console.error("Error fetching option results:", error)); //log any errors
        }
    </script>

</body>
</html>


