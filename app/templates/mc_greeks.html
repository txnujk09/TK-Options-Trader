<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Monte Carlo Option Greeks Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/">Home</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="/portfolio">Portfolio</a></li>
                <li class="nav-item"><a class="nav-link" href="/trade">Trade</a></li>
                <li class="nav-item"><a class="nav-link" href="/mc_greeks">Option Greeks</a></li>
                <li class="nav-item"><a class="nav-link" href="/market-trends">Market Trends</a></li>
                <li class="nav-item"><a class="nav-link" href="/order_history">Order History</a></li>
                <li class="nav-item"><a class="nav-link" href="/trade_history">Trade History</a></li>
            </ul>
        </div>
    </nav>
    <div class="container mt-5">
        <h1>Monte Carlo Option Greeks</h1>
        <form id="mc-greeks-form">
            <div class="mb-3">
                <label for="IS" class="form-label">Initial Stock Price (IS)</label>
                <input type="number" id="IS" class="form-control">
            </div>
            <div class="mb-3">
                <label for="K" class="form-label">Strike Price (K)</label>
                <input type="number" id="K" class="form-control">
            </div>
            <div class="mb-3">
                <label for="T" class="form-label">Time to Expiry (Years)</label>
                <input type="number" id="T" step="0.01" class="form-control">
            </div>
            <div class="mb-3">
                <label for="r" class="form-label">Risk-Free Rate (r)</label>
                <input type="number" id="r" step="0.01" class="form-control">
            </div>
            <div class="mb-3">
                <label for="sigma" class="form-label">Volatility (Ïƒ)</label>
                <input type="number" id="sigma" step="0.01" class="form-control">
            </div>
            <div class="mb-3">
                <label for="option-type" class="form-label">Option Type</label>
                <select id="option-type" class="form-control">
                    <option value="call">Call</option>
                    <option value="put">Put</option>
                </select>
            </div>
            <button type="button" class="btn btn-primary" onclick="calculateMCGreeks()">Calculate</button>
        </form>
        
        <h3 class="mt-4">Results</h3>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Greek</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Delta</td><td id="delta">--</td></tr>
                <tr><td>Gamma</td><td id="gamma">--</td></tr>
                <tr><td>Rho</td><td id="rho">--</td></tr>
                <tr><td>Theta</td><td id="theta">--</td></tr>
                <tr><td>Vega</td><td id="vega">--</td></tr>
            </tbody>
        </table>
        
        <h4><strong>Option Price:</strong> <span class="text-success" id="option-price">--</span></h4>
        
        <button id="calculate-button" class="btn btn-primary">Calculate</button>
    </div>

    <script>
        function calculateMCGreeks() {
            document.getElementById("calculate-button").addEventListener("click", function() {
            // Get user inputs
            let stockPrice = document.getElementById("stock-price").value;
            let strikePrice = document.getElementById("strike-price").value;
            let timeToExpiry = document.getElementById("time-to-expiry").value;
            let riskFreeRate = document.getElementById("risk-free-rate").value;
            let volatility = document.getElementById("volatility").value;
            let optionType = document.getElementById("option-type").value;

            // Send request to backend API
            fetch("/api/get_option_results", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    stock_price: stockPrice,
                    strike_price: strikePrice,
                    time_to_expiry: timeToExpiry,
                    risk_free_rate: riskFreeRate,
                    volatility: volatility,
                    option_type: optionType
                })
            })
            .then(response => response.json())
            .then(data => {
                // Update the results dynamically
                document.getElementById("delta").innerText = data.greeks.Delta.toFixed(2);
                document.getElementById("gamma").innerText = data.greeks.Gamma.toFixed(2);
                document.getElementById("rho").innerText = data.greeks.Rho.toFixed(2);
                document.getElementById("theta").innerText = data.greeks.Theta.toFixed(2);
                document.getElementById("vega").innerText = data.greeks.Vega.toFixed(2);
                document.getElementById("option-price").innerText = data.option_price.toFixed(2);
            })
            .catch(error => console.error("Error fetching option results:", error));
        });
    }
    </script>
</body>
</html>